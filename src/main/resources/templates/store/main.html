<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/assets/css/Header.css" />
    <link rel="stylesheet" href="/assets/css/Footer.css" />
    <link rel="stylesheet" href="/assets/css/pickitupStore.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
</head>
<body>

     <!--헤더  -->

     <div th:replace="~{/main/Header :: HeaderImport}"></div>
   <!--헤더 -->

   <div class="media_store_categories">
    <input type="button" value="전체" class="categories_selected">
    <input type="button" value="생활">
    <input type="button" value="주방">
    <input type="button" value="욕실">
    <input type="button" value="반려동물">
    <input type="button" value="화장품">
    <input type="button" value="식품">
    <input type="button" value="문구">
    <input type="button" value="원예">
 </div>

 <div class="store_all_body">
     <section class="store_container">
         <div class="store_cate_items">
             <div class="store_categories">
                 <ul>
                     <li class="active"><a href="#">전체</a></li>
                     <li><a href="#">생활</a></li>
                     <li><a href="#">주방</a></li>
                     <li><a href="#">욕실</a></li>
                     <li><a href="#">반려동물</a></li>
                     <li><a href="#">화장품</a></li>
                     <li><a href="#">식품</a></li>
                     <li><a href="#">문구</a></li>
                     <li><a href="#">원예</a></li>
                 
                 </ul>
             </div>

             <!-- -----------------------------임시 데이터 --------------------------------->
             <div class="store_items">
                 <div class="onetime">
                     <h4 class="items_header">전체 상품 목록 &nbsp;</h4>
                     <p class="item_headerp" th:text="|${productsCount} 개|"></p>
                 </div>
                 <div class="all_items">
                                     <!--  목록 리스트 시작 -->
                     <ul>
                         <th:block th:each="product:${productlist}">
                             <tr th:object="${product}">
                                 <li>
                                     <div class="item">
                                 <span class="material-symbols-outlined jjim jjim-ajax">
                                     favorite
                                     </span>
<!--                                         <img th:id="*{num}" src="/images/1.jpg">-->
                                         <a class="goDetail" th:href="*{num}"></a>
                                         <div class="flex" style="flex-direction: column; margin: 12px 0;">
                                             <div>
                                                 <p class="store_main_item_title" th:text="*{name}"></p>
                                             </div>
                                             <div style="margin-top: 6px; height: 16px;">
                                                 <p class="store_main_item_category" th:text="*{category}"></p>
                                             </div>
                                             <div style="display: flex; align-items: end; margin-top: 5px">
                                                 <span class="material-symbols-outlined" style="font-size: 12px;">
                                                     favorite
                                                 </span>
                                                 <small style="font-size: 11px; margin-left: 5px">300..</small>
                                             </div>
                                         </div>
                                         <div style="height: 18px;">
                                             <p class="store_item_price" th:text="|*{price}P|"></p>
                                         </div>
                                         </a>
                                     </div>
                                 </li>
                             </tr>
                         </th:block>
                     </ul>
                 </div>
             </div>
             <div class="gototop">
                 <span class="material-symbols-outlined toTop" style="font-size: 35px;">
                     vertical_align_top
                     </span >
             </div> 
         </div>
     </section>
 </div>
 <!-- -----------------------------임시 데이터 --------------------------------->
     <div th:replace="~{/main/Footer :: FooterImport}"></div>
</body>
<!--<script src="/assets/js/store.js"></script>-->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:inline="javascript">
    const $uploadResult = $(".item ul");

    // let productNum = [[${num}]];
    //
    // //scroll top
    $('.gototop').click(function(){
        $('html, body').animate({scrollTop : 0},300);
    });

    $('.goDetail').click(function (e) {
        e.preventDefault();
        location.href = "/store/detail?num="+$(this).attr('href');
    })

    //메인 사진 받아오기
    $('.goDetail').each(function(i, h) {
        let productNum=$(this).attr("href");
        $.ajax({
            url: "/productFile/list/"+productNum,
            type : "get",
            success : function (files) {
                // let str = "<img src='/productFile/display?fileName=" + files[0].uploadPath + "/s_" + files[0].uuid + "_"  + files[0].fileName + "'>";
                let str = "<img src='/productFile/display?fileName=" + files[0].uploadPath + "/s_" + files[0].uuid + "_"  + files[0].fileName + "'>";
                $(h).html(str);
                // $("img#"+productNum).attr("src", "/upload/display?fileName=" + files[0].uploadPath + "/s_" + files[0].uuid + "_"  + files[0].fileName )
            }
        })
    })
    // function showUploadResult(files){
    //     let str ="";
    //     $(files).each(function(i, file){
    //         str += "<li data-filename='" + file.fileName + "' data-uuid='" + file.uuid + "' data-uploadpath='" + file.uploadPath + "' data-image='" + file.image + "'>";
    //         if(file.image){
    //             str += "<a href=\"javascript:showImage(\'" + file.uploadPath + "/" + file.uuid + "_" + file.fileName +"\');\"><img src='/upload/display?fileName=" + file.uploadPath + "/s_" + file.uuid + "_"  + file.fileName + "'></a>";
    //         }else{
    //             str += "<a href='/upload/download?fileName=" + file.uploadPath + "/" + file.uuid + "_" + file.fileName + "'><img src='/images/attach.png' width='100'></a>";
    //         }
    //         str += "<p>" + file.fileName + "</p>"
    //         str += "</li>"
    //     });
    //     $uploadResult.html(str);
    // }

    // (function(){
    //     $.getJSON("/upload/list", {productNum: 23}, function(list){
    //         showUploadResult(list);})
    // })();


    //
    //
    //정상웹 일때
    $('.store_categories li').click(function(){
        $('.store_categories li').removeClass('active');
        if($(this).hasClass('active')){
            $(this).removeClass('active');
        }else{
            $(this).addClass('active');
        }
    })
    //
    //반응형 웹
    $('.media_store_categories input').click(function(){
        $('.media_store_categories input').removeClass('categories_selected');
        if($(this).hasClass('categories_selected')){
            $(this).removeClass('categories_selected');
        }else{
            $(this).addClass('categories_selected');
        }
    })
    //
    $('.jjim-ajax').click(function() {
        if ($(this).hasClass("red")) {
            $(this).removeClass("red");
        } else {
            $(this).addClass("red");
        }
    });

    // 카테고리 클릭시 ajax
    $(".store_categories ul li").click(function (e) {
        e.preventDefault();
    })
</script>

</html>